<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <title>Raptor RDF Parser Toolkit - Release Notes</title>
</head>
<body>

  <h1>Raptor RDF Parser Toolkit - Release Notes</h1>

<h2 id="rel1_4_5"><a name="rel1_4_5">Raptor 1.4.5 Changes</a></h2>

<p>Added a new <em>RDF/XML with abbreviations</em> serializer
<code>rdfxml-abbrev</code> written by Steve Shepard which handles
several of the abbreviations specified by the
<a href="http://www.w3.org/TR/rdf-syntax-grammar/">RDF/XML Syntax Specification (Revised)</a>
W3C Recommendation.  It is suitable for writing small documents as
there are known scaling issues.
</p>

<p>The RSS tag soup parser was updated to work better when there is
no base URI given.  It also now supports reading the 
<a href="http://inamidst.com/rss1.1/">RSS 1.1</a> format and
turning it into RSS 1.0 model triples.</p>

<p>Deprecated <code>raptor_ntriples_string_as_utf8_string</code> as
rather too internal to be useful, since it only works with a parser.
</p>

<p>More fixes to work around the broken libxml2 on Apple OSX 10.3.x
with inconsistent shared libraries / headers.</p>

<p>Experimental and incomplete Notation 3 parser - updated to match
changes to Turtle.  CVS changes only, not enabled in standard builds.
</p>



<h2 id="rel1_4_4"><a name="rel1_4_4">Raptor 1.4.4 Changes</a></h2>

<p>Make the RSS tag soup parser handle RSS 0.9 namespace elements by
turning them into RSS 1.0.</p>

<p>Fix a couple of crashes in the RSS 1.0 serialiser when
no base URI is used.</p>

<p>Make <code>raptor_uri_to_relative_counted_uri_string</code>
work when the base or reference URI have no paths such as like
<em>http://example.org</em>
</p>

<p>Added portability fixes for Win32 to get Raptor 1.4.3 building
with MS Visual Studio using expat and libcurl.  The RAPTOR_INTERNAL
define was moved to the build configuration and defines added for
integral type sizes.  Patch from Dave Viner (dviner at apache dot
org).</p>



<h2 id="rel1_4_3"><a name="rel1_4_3">Raptor 1.4.3 Changes</a></h2>

<p>A release with the major new feature of an XML writer API.
This is now used along with a new supporting XML element class to
improve the existing RDF/XML serializer and to provide a new
<a href="http://purl.org/rss/1.0/spec">RSS 1.0</a> serializer.
</p>

<p>This API it is also used by the next release of
<a href="http://librdf.org/rasqal/">Rasqal</a> to provide serializing
of query results to XML.
</p>

<p>The new <code>raptor_xml_writer</code> class functions added are:
<code>raptor_new_xml_writer</code> (constructor),
<code>raptor_free_xml_writer</code> (destructor),
<code>raptor_xml_writer_empty_element</code>,
<code>raptor_xml_writer_start_element</code>,
<code>raptor_xml_writer_end_element</code>,
<code>raptor_xml_writer_cdata</code>,
<code>raptor_xml_writer_cdata_counted</code>,
<code>raptor_xml_writer_raw</code>,
<code>raptor_xml_writer_raw_counted</code>,
<code>raptor_xml_writer_comment</code> and
<code>raptor_xml_writer_comment_counted</code>.
</p>

<p>The new <code>raptor_xml_element</code> class functions added are:
<code>raptor_new_xml_element</code> (constructor),
<code>raptor_free_xml_element</code> (destructor),
<code>raptor_xml_element_get_name</code>,
<code>raptor_xml_element_set_attributes</code>,
<code>raptor_xml_element_declare_namespace</code> and
<code>raptor_iostream_write_xml_element</code>.
</p>


<h3>Parser Changes</h3>

<p>RSS tag soup parser now works with older libxml2s (2.5.10+),
including the one shipped with some Apple OSX versions that has an
inconsistent header file and library.</p>

<p>RSS tag soup parser recognises/scores more common XML RSS file names.</p>

<p>RSS tag soup parser turns XML RSS
<code>&lt;guid isPermaLink="true"&gt;val&lt;/guid&gt;</code>
into RDF/XML form <code>&lt;guid rdf:resource="val"/&gt;</code>, leaving
the non isPermaLink form to be a literal value.</p>

<p>A bug was found in libxml2 that causes double expanding of XML
entities in RDF/XML.  This has been reported but cannot be worked
around from raptor.  The expat XML parser can be used as an
alternative, as it does not have this problem.  A test was added for
this bug but it will not cause the test suite ('make check') to
fail.</p>

<p>Added additional 
<a href="http://www.ilrt.bristol.ac.uk/discovery/2004/01/turtle/">Turtle</a>
parser tests that cover Notation 3 syntax that is not part of the
Turtle language.</p>

<p>Added
<code>raptor_parser_set_feature_string</code> and
<code>raptor_parser_get_feature_string</code>
methods to set/get string feature values.</p>


<h3>Serializer Changes</h3>

<p>Added feature <code>relative_uris</code> for serializers.  This
is used by the RDF/XML serializer and enabled by default.</p>

<p>Added feature <code>start_uri</code> for serializers with a string
value to set the start URI for serializing.  Not used at present.</p>

<p>Added new methods <code>raptor_serializer_features_enumerate</code>
to list serializer features and functions to set/get serializer
feature integer or strings values:
<code>raptor_serializer_set_feature</code>,
<code>raptor_serializer_get_feature</code>,
<code>raptor_serializer_set_feature_string</code> and
<code>raptor_serializer_get_feature_string</code>.
</p>

<p>Added <code>raptor_serialize_set_namespace</code> to allow user
declaration of prefix/URI namespaces pairs as serializing hints.</p>

<p>the RDF/XML serializer was improved using the new XML Writer class
so it now uses any user-declared namespace hints in it's output and
emits relative URIs whenever possible.  The latter was provided
by a patch from René Puls.</p>

<p>A new 
<a href="http://purl.org/rss/1.0/spec">RSS 1.0</a>
serializer was added, using the new XML Writer class
and using the same structures, classes and properties as the RSS tag
soup parser.</p>


<h3>URI class changes</h3>

<p>Added relative URI generating code from a patch written by René Puls
and provide this with two new methods
<code>raptor_uri_to_relative_uri_string</code> and
<code>raptor_uri_to_relative_counted_uri_string</code>.
</p>

<p>Added <code>raptor_uri_print</code> to print a URI to a file handle.</p>

<p>Added methods <code>raptor_uri_to_string</code> and
<code>raptor_uri_to_counted_string</code> to return a URI as newly
allocated strings.</p>


<h3>I/O Stream Changes</h3>

<p>Many classes gained methods to write to iostreams, supporting the
new XML Writer class functionality.  The added methods are:
<code>raptor_iostream_write_namespace</code>,
<code>raptor_iostream_write_ntriples_string</code>,
<code>raptor_iostream_write_qname</code>,
<code>raptor_iostream_write_statement_ntriples</code>,
<code>raptor_iostream_write_stringbuffer</code>,
<code>raptor_iostream_write_xml_element</code> and
<code>raptor_iostream_write_xml_escaped_string</code>.
</p>


<h3>Namespace Class Changes</h3>

<p>Added <code>raptor_namespace_copy</code> copy
constructor and <code>raptor_new_namespace_from_uri</code>
constructor to build a namespace from a raptor_uri object.</p>

<p>Added utility function <code>raptor_new_namespace_parts_from_string</code>
to decode syntax of the form
<code>xmlns:</code><em>prefix</em><code>="</code><em>uri</em><code>"</code>
into <em>prefix</em> and <em>uri</em> string pairs.
</p>

<p>Added <code>raptor_namespaces_find_namespace_by_uri</code> method
for namespace stack to find a declared namespace by URI.  This
complements <code>raptor_namespaces_find_namespace</code> which
already provides searching by prefix.</p>


<h3>Unicode and UTF-8 Changes</h3>

<p>Added several methods for checking characters forming
parts of XML 1.0 or XML 1.1 names:
<code>raptor_unicode_is_xml10_namestartchar</code>,
<code>raptor_unicode_is_xml11_namestartchar</code>,
<code>raptor_unicode_is_xml10_namechar</code> and
<code>raptor_unicode_is_xml11_namechar</code>.
</p>

<p>Added a function <code>raptor_utf8_check</code> to check that a
string is legal UTF-8 and all the encoded Unicode characters are in
the range U+0 &lt;= character &lt;= U+10FFFF</p>

<p>Added a function <code>raptor_xml_name_check</code> to check that
a string is a legal XML name (1.0 or 1.1) as well as legal UTF-8.</p>


<h3>Other Changes</h3>

<p>Feature support: Added <code>raptor_feature_value_type</code> to
determine value of a feature - either integer (most) or string.</p>

<p>XML QName class: Added <code>raptor_qname_copy</code> copy
constructor.</p>

<p>Sequence class: Added <code>raptor_sequence_join</code>
to join two sequences of items, leaving one empty.</p>

<p>Statement class: Added <code>raptor_statement_copy</code> copy
constructor and <code>raptor_free_statement</code> destructor.
Previously these were internal to raptor.</p>

<p>The <code>rapper</code> utility was modified to add a feature form:
<code>-f xmlns:</code><em>PREFIX</em><code>="</code><em>URI</em><code>"</code>
allowing the setting of output serializer namespaces.</p>

<p>The namespace URI string constants exported by raptor are now of
type unsigned char*.</p>


<h2 id="rel1_4_2"><a name="rel1_4_2">Raptor 1.4.2 Changes</a></h2>

<p>Make <code>raptor_xml_escape_string</code> fail correctly when
given bad UTF-8 to escape.</p>


<h2 id="rel1_4_1"><a name="rel1_4_1">Raptor 1.4.1 Changes</a></h2>

<p>Fixed a buffer overrun in decoding a URI scheme in
<code>raptor_uri</code> constructors such as
<code>raptor_new_uri</code>.</p>

<p>Fixed a crash in RSS enclosures crash when the <code>url</code>
attribute seen on a non-<code>&lt;enclosure&gt;</code> element</p>

<p><code>raptor_xml_escape_string</code> return value has changed to
be an int, returning &lt;0 on failure.  This allows the empty string
encoding an empty string case to work and be distinguished from an
error.
</p>


<h2 id="rel1_4_0"><a name="rel1_4_0">Raptor 1.4.0 Changes</a></h2>

<p>A release with the major new feature of providing serializing of
RDF triples to syntaxes.  It also added a new support class for I/O
streams and had other minor fixes.</p>

<p>Added a Raptor Serializer class (<code>raptor_serializer</code>)
with similar style to Parser (<code>raptor_parser</code>).  Two
serializers are provided, for RDF/XML and N-Triples.  The serializing
can be done to files, C <code>FILE*</code> or to strings.  The
raptor_iostream class that provides this also allows writing
to any other form by creating a custom iostream.
</p>

<p>The new raptor_serializer class functions added are:
<code>raptor_serializers_enumerate</code>,
<code>raptor_serializer_syntax_name_check</code>,
<code>raptor_new_serializer</code>,
<code>raptor_free_serializer</code>,
<code>raptor_serialize_start</code>,
<code>raptor_serialize_start_to_filename</code>,
<code>raptor_serialize_start_to_string</code>,
<code>raptor_serialize_start_to_file_handle</code>,
<code>raptor_serialize_statement</code>,
<code>raptor_serialize_end</code>,
<code>raptor_serializer_get_iostream</code>,
<code>raptor_serializer_set_error_handler</code>,
<code>raptor_serializer_set_warning_handler</code> and
<code>raptor_serializer_get_locator</code>
</p>

<p>Added a Raptor I/O stream abstraction in
<code>raptor_iostream</code> class to support serializing of RDF to
multiple output streams such as to filenames, to C standard I/O
<code>FILE*</code> handles and to strings especially for
cross-language use.  A <code>raptor_iostream_handler</code> can
be used to construct a user-defined iostream.
</p>

<p>The new raptor_iostream class functions added are:
<code>raptor_new_iostream_from_handler</code>,
<code>raptor_new_iostream_to_sink</code>,
<code>raptor_new_iostream_to_filename</code>,
<code>raptor_new_iostream_to_file_handle</code>,
<code>raptor_new_iostream_to_string</code>,
<code>raptor_free_iostream</code>,
<code>raptor_iostream_write_bytes</code>,
<code>raptor_iostream_write_byte</code>,
<code>raptor_iostream_write_end</code>,
<code>raptor_iostream_write_string</code>,
<code>raptor_iostream_write_counted_string</code>,
<code>raptor_iostream_get_bytes_written_count</code>,
<code>raptor_iostream_write_decimal</code> and
<code>raptor_iostream_format_hexadecimal</code>.
</p>


<p>The <code>rapper</code> utility was modified to use serializer
class so that the output formats supported are now N-Triples
(<code>-o ntriples</code>) - the default, and RDF/XML (<code>-o
rdfxml</code>).</p>


<p>Raptor now exports more static namespace URI strings for
general application use:
<code>raptor_xml_namespace_uri</code>,
<code>raptor_rdf_namespace_uri</code>,
<code>raptor_rdf_schema_namespace_uri</code>,
<code>raptor_xmlschema_datatypes_namespace_uri</code>,
<code>raptor_owl_namespace_uri</code>,
and the length
<code>raptor_rdf_namespace_uri_len</code>.
</p>

<p>The raptor_stringbuffer class gained a new method
<code>raptor_stringbuffer_copy_to_string</code>
which allows efficient copy-out of a constructed string.
</p>

<p>The raptor_www class gained a new method
<code>raptor_www_fetch_to_string</code> to allow retrieving of
web content as a single string.
</p>

<p>RSS tag soup parser gained support for generating triples for
enclosures, after a patch from Suzan Foster.  Changes made include
correcting the enclosures namespace and tidying some memory leaks.
</p>


<h2 id="rel1_3_3"><a name="rel1_3_3">Raptor 1.3.3 Changes</a></h2>

<p>A release with major improvements along with several minor fixes.</p>

<p>Raptor's License was changed from LGPL 2.1/MPL 1.1 to
LGPL 2.1/Apache 2</p>

<p>Thanks to Chris Pointon for several patches to make Raptor
easier to build under Win32 which were applied, with some slight
modifications.</p>

<p>Increased WWW content retrieval buffer size from 256 bytes to 4K
since this was causing problems for even moderate size documents.</p>

<p>After testing raptor on a very large RDF/XML file with many
<code>rdf:ID</code> values, the check for duplicate values was found
to be inefficient in memory and slow.  The implementation was
improved to be more memory efficient and a new parser feature
<code>check_rdf_id</code> was added to disable checking (default is
enabled).</p>

<p>Added a new Unicode NFC checker to replace the functionality
formally available by calling the GNOME glib function
g_utf8_normalize.  This new checker is done via several tables and
adds approximately 50K to the object size of the library when
compiled on x86.  This code and tables can be disabled with configure
option <code>--disable-nfc-check</code> causing all checks to
succeed.</p>

<p>Fix the exporting of
<code>raptor_xml_literal_datatype_uri_string</code> and
<code>raptor_xml_literal_datatype_uri_string_len</code> as constants
for use by applications.  Previously raptor.h wasn't doing this
correctly.</p>

<p>Added <code>raptor_calloc_memory</code> for allocating zeroed
memory inside raptor, for use by applications passing memory in/out
of raptor.</p>

<p>Added a new configure option <code>--enable-parsers</code> to
allow the selection of the required RDF parsers from any of those
supported (RDF/XML, Turtle, N-Triples, RSS tag soup).
</p>

<p>Reorganised the sources to split parsing support from RDF/XML
to support compiling without this parser.</p>

<p>Updated the RSS Tag Soup parser to start to handle the Atom 0.3
currently being standardised by the
<a href="http://www.ietf.org/html.charters/atompub-charter.html">IETF Atom Publishing Format and Protocol</a>
working group.
</p>

<p>Altered the Turtle parser to work with large source documents that
exceeded bison limits.  Thanks to Geoff Chappell for providing a fix for
this.</p>

<p>Rewrote the URI parsing to create an internal structure and
improved the relative URI resolving in preparation for future work
such as potentially supporting URI canonicalisation such as proposed
to be used by Atom.</p>


<h2 id="rel1_3_2"><a name="rel1_3_2">Raptor 1.3.2 Changes</a></h2>

<p>A release with some minor fixes.</p>

<p>Added a new configure option
<code>--with-expat-source=</code><em>DIR</em>
to allow the use of external expat source trees in either the old or
newer directory structure style. (Patch from Mark Smith).</p>

<p>Added <code>raptor_alloc_memory</code> for handlers that need to
allocate memory in the same heap as raptor uses for
<code>raptor_free_memory</code>. This is mostly useful for allocating
memory that is freed by raptor in error, ID and statement handlers
on win32 which has separate heaps for different DLLs.</p>

<p>A bug was fixed where errors which happened when fetching WWW
content were always printed to stderr.  They are now passed to the
main error routines which allows applications to retrieve them.</p>

<p>Accessor functions were added for parts of the public
<code>raptor_locator</code> structure which makes it possible to get
structured error information from language bindings via Redland
(Patch from Edd Dumbill).  The new functions are:</p>

<ul>
<li><code>int raptor_locator_line(raptor_locator *locator);</code></li>
<li><code>int raptor_locator_column(raptor_locator *locator);</code></li>
<li><code>int raptor_locator_byte(raptor_locator *locator);</code></li>
<li><code>const char * raptor_locator_file(raptor_locator *locator);</code></li>
<li><code>const char * raptor_locator_uri(raptor_locator *locator);</code></li>
</ul>

<p>The Unicode Normal Form C (NFC) checking via the GNOME glib
library function <code>g_utf8_normalize</code> is broken, comparing
the data it says is failed against other NFC checkers.  It is also
slower than need be since it is doing full normalizing rather than
just checking for NFC, and adds a rather large dependency for just
one function.  A new portable checker will be added in a later
release.</p>




<h2 id="rel1_3_1"><a name="rel1_3_1">Raptor 1.3.1 Changes</a></h2>

<p>A release primarily to fix some win32 and portability issues.</p>

<p>raptor.h now includes stdarg.h</p>

<p>Corrected the <code>raptor_print_statement</code> declaration in
raptor.h for the argument statement to have one less 'const' which
matches the actual code.</p>

<p>Made several portability fixes for compiling natively on win32
which doesn't quite do POSIX or C99.</p>

<p>Changed the support for file: URIs and converting to and from
filenames.  It now %-escapes spaces and % characters on conversion
to and from filenames with
<code>raptor_uri_uri_string_to_filename</code>,
<code>raptor_uri_uri_string_to_filename_fragment</code>
and
<code>raptor_uri_filename_to_uri_string</code>.
For Win32, more tests were added and the
format of URIs supported corrected to use the <code>file:///c:</code>
form rather than <code>file://c|/</code></p>

<p>URIs that resolve to directories now return an error when lstat is
available to check.</p>



<h3>Parser Changes</h3>

<p>The
<a href="http://www.ilrt.bristol.ac.uk/discovery/2004/01/turtle/">Turtle</a>
parser was updated to only allow language with non-datatyped literals,
allow a '_' immediately after a ':' in qnames and to make a bare ':'
qname work correctly.
</p>

<p>The Turtle parser was fixed to re-initialise correctly when
performing multiple parsings.  The other parsers already did this
correctly.</p>

<p>Added a warning to the RDF/XML parser for unknown
<code>rdf:parseType</code> values, when parsing in lax mode - which
is the default.  It now tells the user when the parsing is working as
'Literal' mode by finding an unknown value.  This is controlled by a
new parser feature warn_other_parsetypes which is default set true
in lax mode.  Parser modes are controlled by the
<code>raptor_set_parser_strict</code> method.</p>



<h2 id="rel1_3_0"><a name="rel1_3_0">Raptor 1.3.0 Changes</a></h2>

<p>A release primarily to provide support for
the new <a href="http://librdf.org/rasqal/">Rasqal</a>
RDF query library but with some new features and fixes.</p>


<h3>Parser Changes</h3>

<p>Added a new constructor
 <code>raptor_new_parser_for_content</code> to guess the parser to use
from hints in URIs or content, using a new utility function
<code>raptor_guess_parser_name</code>.</p>

<p>Additional checks were added to the RDF/XML parser for
RDF-namespaced names in element and attributes and if they are
forbidden giving an error otherwise if unknown, giving a warning.</p>

<p>The
<a href="http://www.ilrt.bristol.ac.uk/discovery/2004/01/turtle/">Turtle</a>
parser was updated to correct the collections syntax, allow '-' in
names and QNames and to add integer literals.  This parser now correctly
uses <code>raptor_generate_id</code> when a blank identifier name is
needed.</p>

<p>Completed parser feature support by adding <code>raptor_get_feature</code>,
<code>raptor_feature_from_uri</code>, and
<code>raptor_features_enumerate</code> to get values and enable
discovery of supported features at run time.
<code>raptor_set_feature</code> was changed to give return a success
value</p>

<p>Added a new method <code>raptor_get_mime_type</code> to get the
MIME type of the syntax for a parser</p>

<p><code>raptor_parse_uri_with_connection</code> (which is called by
<code>raptor_parse_uri</code>) now sets the HTTP <code>Accept:</code>
header to the MIME type of the parser in WWW requests using the new
<code>raptor_www_set_http_accept</code>.
</p>


<h3><code>rapper</code> changes</h3>

<p>Added options <code>-f</code>/<code>--feature</code> for setting
features and <code>-g</code>/<code>--guess</code> for guessing syntax
from some content or identifiers.  See <a href="rapper.html">rapper(1)</a>
for all rapper options.</p>


<h3>Utility function changes</h3>

<p>Added <code>raptor_syntax_name_check</code> to check for valid
syntax language names.<br />
</p>

<p>Added <code>raptor_free_memory</code> to free memory returned by
raptor functions.</p>

<p>Added Unicode utility functions <code>raptor_unicode_char_to_utf8</code> and
<code>raptor_utf8_to_unicode_char</code>.</p>

<p>Exported URI string <code>raptor_xml_literal_datatype_uri_string</code>.</p>

<p>Deprecated <code>raptor_print_statement_detailed</code> always
intended to be internal.</p>


<h3>WWW Class changes</h3>

<p>Added support to set the HTTP <code>Accept:</code> header for curl
and libxml2 when retrieving HTTP content by the new
<code>raptor_www_set_http_accept</code> method.
</p>


<h3>New classes - Sequence and Stringbuffer</h3>

<p>Added a utility class <code>raptor_sequence</code> providing
simple sequences that can handle stacks and queues</p>

<p>Added a utility class <code>raptor_stringbuffer</code> 
for constructing strings from substrings appended or prepended.</p>



<h2 id="rel_older"><a name="rel_older">Raptor 0.9.0 - Raptor 1.2.0 Changes</a></h2>

<p>Release notes for 1.2.0 and earlier are in the
<a href="NEWS.html">NEWS page</a> or
<a href="ChangeLog">ChangeLog</a>
</p>



<hr />

<p>Copyright 2003-2005 <a href="http://purl.org/net/dajobe/">Dave Beckett</a>, <a href="http://www.ilrt.bris.ac.uk/">Institute for Learning and Research Technology</a>, <a href="http://www.bristol.ac.uk/">University of Bristol</a></p>

</body>
</html>
